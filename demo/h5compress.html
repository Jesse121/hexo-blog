<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>Document</title></head><body><input type="file" name class="container" multiple><script>var handler={init:function(e){e.addEventListener("change",function(e){if(this.value){var n=this.files[0];handler.readImgFile(n),this.value=""}})},readImgFile:function(t){var e=new FileReader(t);console.log("原图大小",t.size),"image"===t.type.split("/")[0]?(e.onload=function(e){var n=e.target.result;console.log(n);var a=new Image;a.onload=function(){handler.compress(a,200,t.type)},a.src=n},e.readAsDataURL(t)):alert("you should choose an image file")},compress:function(e,n,a){var t=document.createElement("canvas"),r=e.naturalWidth,i=e.naturalHeight,o=r/i;n<r&&(i=(r=n)/o),t.width=r,t.height=i,t.getContext("2d").drawImage(e,0,0,e.naturalWidth,e.naturalHeight,0,0,r,i);var l=50<r?.5:200<r?.6:1,d=t.toDataURL(a,l);console.log("压缩后图片大小",handler.base64Size(d));var s=new Image;s.onload=function(){document.body.appendChild(s)},s.src=d},base64Size:function(e){var n=e.substring(22);0<n.indexOf("=")&&(n=n.substring(0,n.indexOf("=")));var a=n.length;return parseInt(a-a/8*2)}};handler.init(document.querySelector(".container"))</script></body></html>